# 提案: ヘルスチェックAPIの強化

## 概要

現在の簡易的なヘルスチェックエンドポイントを、Pydanticモデルを使用した構造化されたレスポンスに改善し、MySQL データベースへの接続状態も確認できるようにする。

## 解決したい課題

1. **運用監視の困難さ**: 現在の `/health` エンドポイントは固定の `{"status": "healthy"}` を返すのみで、実際のアプリケーション状態を反映していない
2. **障害検知の遅れ**: データベース接続障害が発生しても、ヘルスチェックでは検知できない
3. **型安全性の欠如**: レスポンスが `dict` 型で定義されており、APIドキュメントに正確なスキーマが反映されない

## 提供するユーザー体験

### 対象ユーザー
- インフラ/SRE エンジニア
- 監視システム（Kubernetes、ロードバランサー等）

### ユースケース

1. **コンテナオーケストレーション**: Kubernetes の liveness/readiness probe としてヘルスチェックAPIを使用し、異常なコンテナを自動的に再起動・トラフィック除外する
2. **ロードバランサー連携**: ALB/NLB のターゲットヘルスチェックとして使用し、不健全なインスタンスへのルーティングを停止する
3. **監視アラート**: データベース接続障害を早期に検知し、アラートを発報する

## 期待されるレスポンス形式

### 正常時 (HTTP 200)
```json
{
  "status": "healthy",
  "database": {
    "status": "connected"
  }
}
```

### 異常時 (HTTP 503)
```json
{
  "status": "unhealthy",
  "database": {
    "status": "disconnected",
    "error": "Connection refused"
  }
}
```

## スコープ

### 含まれるもの
- ヘルスチェックレスポンス用の Pydantic スキーマ
- データベース接続確認ロジック
- 既存 `/health` エンドポイントの更新

### 含まれないもの
- 認証・認可
- 外部サービス（Redis、外部API等）の接続確認
- メトリクス収集

## 関連する既存機能

- `app/main.py:23-25`: 現在のヘルスチェックエンドポイント
- `app/db/session.py`: データベースセッション管理
